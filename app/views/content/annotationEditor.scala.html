@(content: models.Content, resourceLibraryUrl: String)(implicit request: RequestHeader, user: User)

@contentIcons = @{
    Map(
        'video -> "icon-film",
        'audio -> "icon-volume-up",
        'image -> "icon-picture",
        'text -> "icon-file",
        'playlist -> "icon-list-ol",
        'activity -> "icon-pencil"
    )
}

@moreStyles =  @{
    List(
      ("screen", "stylesheets/content.css"),
      ("screen", "stylesheets/annotations.css")
    )
}

@course = @{
    request.queryString.get("course").flatMap(s => Course.findById(s(0).toLong))
}

@main("Ayamel - " + content.name, moreStyles) {

    <!-- Ayamel scripts -->
    <script src="@routes.Assets.at("Ayamel.js/js/async.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("Ayamel.js/js/annotator.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("Ayamel.js/js/Resource.js")" type="text/javascript"></script>

    <script type="text/javascript" src="@routes.Assets.at("Ayamel.js/js/player2/js/Ayamel.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("Ayamel.js/js/player2/js/Mobile.js")"></script>

    <!-- Timed text -->
    <script type="text/javascript" src="@routes.Assets.at("TimedText/TimedText.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("TimedText/TextTrack.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("TimedText/TextTrackCue.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("TimedText/WebVTT.js")"></script>

    <!-- Content rendering -->
    <script type="text/javascript" src="@routes.Assets.at("javascripts/mustache.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/BoxDrawingCanvas.js")"></script>

    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/AdditionalDocumentLoader.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/ContentLayoutManager.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/ContentRenderer.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/TranscriptDisplay.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/ImageRenderer.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/TextRenderer.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/contentRendering/VideoRenderer.js")"></script>

    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotating/ImageAnnotation.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotating/TextAnnotation.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotating/AnnotationManifest.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotating/ImageAnnotator.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotating/TextAnnotator.js")"></script>
    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotating/AnnotationLoader.js")"></script>

    <script type="text/javascript" src="@routes.Assets.at("javascripts/annotationEditing/AnnotationEditor.js")"></script>

    <div class="padded">

        <h1><i class="@contentIcons(content.contentType)"></i> @content.name <small>Edit Annotations</small></h1>

        <div id="annotationEditor"></div>

        <script type="text/javascript">
            $(function() {

                ContentRenderer.setResourceLibraryUrl("@resourceLibraryUrl");
                var content = @Html(content.toJson.toString());

                var $annotationEditor = $("#annotationEditor");
                var editor = new AnnotationEditor({
                    $container: $annotationEditor,
                    content: content,
                    userId: "@user.id.get",
                    owner: [@content.isEditableBy(user)][0],
                    teacher: [@course.map(c => user.canEdit(c)).getOrElse(false)][0],
                    courseId: [@course.map(_.id.get).getOrElse(0)][0],
                    resourceLibraryUrl : "@resourceLibraryUrl"
                });
            });
        </script>

    </div>
}
