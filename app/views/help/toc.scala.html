@(pages: Map[String, List[HelpPage]])(implicit request: RequestHeader, user: Option[User])

@template(title: String)(content: Html)(r: RequestHeader, u: Option[User]) = @{
    if(user.isDefined)
        main(title)(content)(r, u.get)
    else
        simple(title)(content)(r, u)
}

@template("Ayamel - Help Pages") {

    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/help.css")"/>

    <div class="padded">

        <h1>Help and Tutorial Pages</h1>

        <p>
            Understanding how Ayamel works can be difficult. We know. For that reason we are working hard on creating a
            series of tutorials in order to help you do what you need to do. However, it is a work in progress and many
            are not ready yet.
        </p>

        @if(user.isDefined && user.get.role == User.roles.admin) {
            <a href="@routes.HelpPages.edit(0)" class="btn btn-yellow pad-bottom-med"><i class="icon-plus"></i> Create a new help page</a>
        }

        <div id="helpTOC">
            <div id="helpCategories">
                @for(category <- pages.keys.toList.sortWith(_ < _)) {
                    <div data-target="@category">
                        @category
                        <div class="point1"></div><div class="point2"></div>
                    </div>
                }
            </div>
            <div id="helpPages">
                @for(category <- pages.keys) {
                    <div data-name="@category">
                        @for(page <- pages(category).sortBy(_.title)) {
                            <div><a href="@routes.HelpPages.view(page.id.get)">@page.title</a></div>
                        }
                    </div>
                }
            </div>
        </div>

        <script type="text/javascript">
            $(function() {
                var $categories = $("#helpCategories").children();
                var $helpPages = $("#helpPages").children();
                $categories.click(function() {
                    $categories.removeClass("active");
                    $(this).addClass("active");

                    $helpPages.removeClass("active");
                    $helpPages.filter("div[data-name=\"" + $(this).attr("data-target") + "\"]").addClass("active");
                });
            });
        </script>

    </div>
}(request, user)