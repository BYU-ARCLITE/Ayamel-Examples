@(helpPage: HelpPage, resourceLibraryUrl: String)(implicit request: RequestHeader, user: User)

@processContents(page: HelpPage) = @{
    page.contents.replaceAll("\\[content:(\\d+)\\]", "<div class=\"contentDisplay\" data-id=\"$1\"></div>")
}

@main("Ayamel - " + helpPage.title){

    @views.html.content.dependencies()

    <div class="padded">
        <div>
            <div class="pull-left">
                <h1>@helpPage.title</h1>
            </div>

            <div class="pull-right">
                @if(user.role == User.roles.admin) {
                    <a class="btn btn-yellow pad-top-med" href="@routes.HelpPages.edit(helpPage.id.get)"><i class="icon-edit"></i> Edit</a>
                }
            </div>
        </div>
        <div class="clearfix"></div>

        <div>
            @Html(processContents(helpPage))
        </div>
    </div>

    <script type="text/javascript">
        $(function() {
            // Enable the content
            ContentRenderer.setResourceLibraryUrl("@resourceLibraryUrl");
            $('.contentDisplay').each(function () {
                var $this = $(this);
                ContentRenderer.render({
                    content: Number($this.attr("data-id")),
                    holder: $this,
                    annotate: true
                });
            });
        });
    </script>
}