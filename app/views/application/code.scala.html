@()(implicit request: RequestHeader, user: User)

@main("Code") {

	<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>

    <div class="container">

        @views.html.application.navbar("code")

        <h1>Code examples</h1>
	        <ul>
		        <li>
			        <h2>Level 1 Playback</h2>
			        
					<span>The scope at this base level is to offer high quality video viewing through a media player.</span>
					
					<span>The scripts below are essential to create a level 1 playback</span>
					
					<div>
					<table class="table table-bordered">
					<tr>
						<th>Script</th>
						<th>Description</th>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/Ayamel.js">Ayamel</a></td>
						<td>Core of Ayamel player</td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/ControlBar.js">ControlBar</a></td>
						<td></td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/ControlBarComponents.js">ControlBarComponents</a></td>
						<td></td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/h5Clip.js">h5Clip</a></td>
						<td></td>
					</tr>		
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/ProgressBar.js">ProgressBar</a></td>
						<td></td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/MediaController.js">MediaController</a></td>
						<td>Define functionality for button</td>
					</tr>		
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/TimedMedia.js">TimedMedia</a></td>
						<td></td>
					</tr>				
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/UniformAspectRatio.js">UniformAspectRatio</a></td>
						<td>Set the size for video player</td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/video.js">Video</a></td>
						<td></td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel.js/blob/master/VideoPlayer.js">VideoPlayer</a></td>
						<td></td>
					</tr>
					</table>
					</div>
					
					<span>Here is an example of utilizing the code above to create a level 1 playback.</span>
						<pre class="prettyprint prettyprinted">
							<code class="language-javascript">//Step 1: Include the scripts
							<!-- Jquery support -->
							>script src="/assets/javascripts/jquery-1.9.0.min.js" type="text/javascript"></script>
							
							<!-- Include the Ayamel css files -->
			    			>link rel="stylesheet" media="screen" href="/assets/stylesheets/controlBar2.css">
			    			>link rel="stylesheet" media="screen" href="/assets/stylesheets/stage.css">
							
							<!-- Resource Library Scripts -->
			    			>script src="/assets/javascripts/resources.js" type="text/javascript"></script>
			    			
			    			<!-- Ayamel scripts -->
							>script src="/assets/javascripts/Ayamel.js/Ayamel.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/h5Clip.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/MediaController.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/MediaControls.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/TimedMedia.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/UniformAspectRatio.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/video.js" type="text/javascript"></script>
			    			>script src="/assets/javascripts/Ayamel.js/VideoPlayer.js" type="text/javascript"></script>
							
							// Step 2: Load the resource
							//Include a resourceId to identify which video you are looking for from the database
					        var resourceId = "512cfb8b35e544210c000001";
					
					        $(function() {
					            // This function takes resourceId as a parameter and retrieves the video files with it from the database 
					            new Resource(resourceId, function(resource) {
					            
					                // Step 3: Install the html5 video player
					                // Call AddVideoPlayer method to install video player. h5PlayerInstall is a script that instructs what to install
					                Ayamel.AddVideoPlayer(h5PlayerInstall, 1, function() {
					                    
					                    	// Step 4: Create the player
					                    	// Use "new" to create new object instance of the video player. 
					                    	//Ayamel.Videoplayer method takes all the pre-defined properties and params (aspectratio - ratio of the width to the height of the video player and resource) and places the video into the <div> element named "player"
					                    	var videoPlayer = new Ayamel.VideoPlayer({
					                        element: document.getElementById('player'),
					                        aspectRatio: 45,
					                        resource: resource
					                    });
					                });
					            });
					        });
						</code>
					</pre>
				</li>
				
				<li>
					<h2>Level 2 Playback</h2>
					<span>The scope at this level is to provide high quality video content with a subtitle track providing transcription of the video in the target language or in English.</span>
					<div>In addition to the scripts above, there are other scripts need to be included to create a level 2 playback</div>
					
					<div>
					<table class="table table-bordered">
					<tr>
						<th>Script</th>
						<th>Description</th>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/Ayamel-Examples/blob/master/public/javascripts/Caption-Renderer/caption-renderer.js"></a>Caption-Renderer</td>
						<td>Render subtitles into video</td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/TimedText/blob/master/TimedText.js"></a>TimedText</td>
						<td></td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/TimedText/blob/master/TextTrack.js"></a>TextTrack</td>
						<td></td>
					</tr>
					<tr>
						<td><a href="https://github.com/BYU-ARCLITE/TimedText/blob/master/TextTrackCue.js"></a>TextTrackCue</td>
						<td></td>
					</tr>
					<tr>
						<td><a href=""></a>WebVTT</td>
						<td>Decodes subtitles format</td>
					</tr>
					</table>
					</div>
					
						<pre class="prettyprint prettyprinted">
							<code class="language-javascript">
								// Step 1: Include the scripts (with level 1 playback's)
							    <!-- Caption Renderer script -->
							    >script src="/assets/javascripts/Caption-Renderer/caption-renderer.js" type="text/javascript"></script>
							
							    <!-- Timed Text scripts -->
							    >script src="/assets/javascripts/TimedText/TimedText.js" type="text/javascript"></script>
							    >script src="/assets/javascripts/TimedText/TextTrack.js" type="text/javascript"></script>
							    >script src="/assets/javascripts/TimedText/TextTrackCue.js" type="text/javascript"></script>
							    >script src="/assets/javascripts/TimedText/WebVTT.js" type="text/javascript"></script>
								
								// Step 2: Create a dropdown menu that includes all the available caption tracks				
								$(function() {
								
								    var renderer;
								
									// Since all captions are dynamically generated, this function makes sure all captions are placed in the dropdown menu
								    function createCaptionSelectionMenu(parentElement) {
								        var template =
								            '<div class="dropdown">' +
								            '    <a class="btn btn-inverse" data-toggle="dropdown" href="#">Select Caption Track <b class="caret"></b></a>' +
								            '    <ul class="dropdown-menu" id="captionTracks" role="menu" aria-labelledby="dLabel">' +
								            '    </ul>' +
								            '</div>';
										
										// Append caption to the dropdown menu
								        $(parentElement).append(template);
								    }
								
									// This function adds each dynamically generated caption track to selection menu and assigns an icon to it
								    function addTrackToCaptionSelectionMenu(track) {
								        var activeIconTemplate = '<i class="icon-eye-open"></i> ',
								            template = '<li><a href="#">{{>active}}{{name}}</a></li>',
								            html = Mustache.to_html(template, {
								                name: track.label
								            }, {
								                active: track.mode === "showing" ? activeIconTemplate : ""
								            });
								
										// 
								        $("#captionTracks")
								            .append(html)
								            .find("li:last-child > a")
								            .click(function () {
								                // Disable all the tracks
								                renderer.tracks.forEach(function (track) {
								                    track.mode = "disabled";
								                });
								
								                // Remove the icons
								                $("#captionTracks").find(".icon-eye-open").remove();
								
								                // Enable this track
								                track.mode = "showing";
								
								                // Add the icon
								                $(this).prepend(activeIconTemplate);
								            });
								    }
								
								    // Step 4: Load the resource
								    new Resource(video.resourceId, function(resource) {
								
								        // Step 5: Install the html5 video player
								        Ayamel.AddVideoPlayer(h5PlayerInstall, 1, function() {
								            var player = $('#player').get(0),
								
								                // Step 6: Create the player
								                // an addition param "components" is included in the method to define what buttons to display in the video player
								                videoPlayer = new Ayamel.VideoPlayer({
								                    element: player,
								                    aspectRatio: 45,
								                    resource: resource,
								                    components: ["play", "volume", "captions"]
								                }),
								                videoElement = $("#player").find("video").get(0),
								                captionsElement = $("#captions").get(0);
								
								            // Step 7: Create the caption renderer
								            // CaptionRenderer handles subtitles display in video
								            // 
								            renderer = new CaptionRenderer(videoElement, {
								                appendCueCanvasTo: captionsElement,
								                styleCue: function(DOMNode, track){
								                    return DOMNode;
								                }
								            });
								
								            // Step 8: Bind the caption renderer to the video element
								            renderer.bindMediaElement(videoElement);
								
								            // Create the caption track menu
								            createCaptionSelectionMenu(videoPlayer.controls.captionElement);
								
								            // Add the caption tracks
								            video.captionTracks.forEach(function (captionTrack) {
								
								                // Start by getting the resource
								                new Resource(captionTrack.resourceId, function (resource) {
								
								                    // Step 9: Create a text track
													// this method retrieves track's necessary information and display it in dropdown menu
								                    TextTrack.get({
								                        kind: "subtitles",
								                        label: captionTrack.name,
								                        lang: captionTrack.language,
								                        url: resource.content.files[0].downloadUri,
								                        success: function(){
								                            var track = this;
								                            renderer.addTextTrack(track);
								
								                            // If this is the first track then show it
								                            if(renderer.tracks.length === 1) {
								                                track.mode = 'showing';
								                            }
								
								                            // Add the track to the selection menu
								                            addTrackToCaptionSelectionMenu(track);
								                        }
								                    });
								                });
								            });
								        });
								    });
								});
						</code>
					</pre>
				</li>
				
				<li>
				<h2>Level 3 Playback</h2>
				<span>The scope of this level is to add the ability to click on any word in the subtitle track and be given a direct translation for that word (provided by Google Translate or comparable Web service)</span>
				
				<span>Additional scripts to include:</span>
				
				<div>
				<table class="table table-bordered">
				<tr>
					<th>Script</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><a href="https://github.com/BYU-ARCLITE/Ayamel-Examples/blob/master/public/javascripts/Translate.js/TextTranslator.js">TextTranslator</a></td>
					<td></td>
				</tr>
				<tr>
					<td><a href="https://github.com/BYU-ARCLITE/Ayamel-Examples/blob/master/public/javascripts/Translate.js/ArcliteTranslationEngine.js">ArcliteTranslationEngine</a></td>
					<td>Arclite translation engine</td>
				</tr>
				<tr>
					<td><a href="https://github.com/BYU-ARCLITE/Ayamel-Examples/blob/master/public/javascripts/Translate.js/WordReferenceTranslationEngine.js">WordReferenceTranslationEngine</a></td>
					<td>Word Reference translation engine</td>
				</tr>
				<tr>
					<td><a href="https://github.com/BYU-ARCLITE/Ayamel-Examples/blob/master/public/javascripts/Translate.js/GoogleTranslationEngine.js">GoogleTranslationEngine</a></td>
					<td>Google translation engine</td>
				</tr>
				</table>
				</div>
				
				
				<pre class="prettyprint prettyprinted">
					<code class="language-javascript">
					// Step 1: Include the scripts (with level 2 scripts)
				    <!-- Translation scripts -->
					>script src="/assets/javascripts/Translate.js/TextTranslator.js" type="text/javascript"></script>
					>script src="/assets/javascripts/Translate.js/ArcliteTranslationEngine.js" type="text/javascript"></script>
					>script src="/assets/javascripts/Translate.js/WordReferenceTranslationEngine.js" type="text/javascript"></script>
					>script src="/assets/javascripts/Translate.js/GoogleTranslationEngine.js" type="text/javascript"></script>
					
					$(function() {

					var renderer,
						translator;

					// Set up the translator
					translator = new TextTranslator($("#definitions").get(0));
					translator.addTranslationEngine(arcliteTranslationEngine, 1, 3);
					translator.addTranslationEngine(wordReferenceTranslationEngine, 2, 2);
					translator.addTranslationEngine(googleTranslationEngine, 3, 1);

					// Load the resource
					new Resource(video.resourceId, function(resource) {

						// Install the html5 video player
						Ayamel.AddVideoPlayer(h5PlayerInstall, 1, function() {
							var player = $('#player').get(0),

								// Create the player
								videoPlayer = new Ayamel.VideoPlayer({
									element: player,
									aspectRatio: 45,
									resource: resource,
									components: ["play", "volume", "captions"]
								}),
								videoElement = $("#player").find("video").get(0),
								captionsElement = $("#captions").get(0);

							// Create the caption renderer
							renderer = new CaptionRenderer(videoElement, {
								appendCueCanvasTo: captionsElement,
								styleCue: function(DOMNode, track){
									translator.attach(DOMNode, track.language, "en");
									return DOMNode;
								}
							});

							// Bind the caption renderer to the video element
							renderer.bindMediaElement(videoElement);

							// Add the caption tracks
							var captionComponent = videoPlayer.controls.getComponent("captions");
							video.captionTracks.forEach(function (captionTrack) {

								// Start by getting the resource
								new Resource(captionTrack.resourceId, function (resource) {

									// Create a text track
									// Get all the information of a texttrack
									TextTrack.get({
										kind: "subtitles",
										label: captionTrack.name,
										lang: captionTrack.language,
										url: resource.content.files[0].downloadUri,
										success: function(){
											var track = this;
											renderer.addTextTrack(track);

											// If this is the first track then show it
											if(renderer.tracks.length === 1) {
												track.mode = 'showing';
											}

											// Add the track to the selection menu
											captionComponent.addTrack(track);
										}
									});
								});
							});
						});
					});
				});
					</code>
				</pre>
			</li>
			
			<li>
				<h2>Level 4 Playback</h2>
				
				<span>The scope of this level is to add the ability for the author to gloss words and/or phrases that have a specific contextual meaning. These include, for example, idiomatic phrases or notes that provide contextual information on culture or language notes based on grammar. This level provides contextual meaning for the definition of words/phrases so that their meaning matches the phrase¡¦s employment of that word/phrase </span>			
				<div>
				<table class="table table-bordered">
				<tr>
					<th>Script</th>
					<th>Description</th>
				</tr>
				<tr>
					<td><a href="https://github.com/BYU-ARCLITE/Ayamel-Examples/blob/master/public/javascripts/SimpleAnnotator.js">SimpleAnnotator</a></td>
					<td>Highlighted words/groups of words and fly-out side tabs that provide the written annotation of glossed words and phrases</td>
				</tr>
				</table>
				</div>
				
				<pre class="prettyprint prettyprinted">
					<code class="language-javascript">//Step 1: Include the script (with level 3 scripts)
						>script src="/assets/javascripts/SimpleAnnotator.js" type="text/javascript"></script>
						$(function() {

						var renderer,
							translator;

						var matchData = [
							new SimpleAnnotator.MatchData(/fils/g, "This means son."),
							new SimpleAnnotator.MatchData(/retrouve/g, '<img src="http://simplycatbreeds.org/images/Kitten.jpg" alt="cute!" />'),
							new SimpleAnnotator.MatchData(/la justice/g, '... Something <strong>can</strong> <em>go</em> here.')
						];

						var annotatorHandler = function(item, content) {
					//                $("#annotations").html("<h3>" + $(item).text() + "</h3>" + content);
						};

						var annotatorSetup = function(item, content) {
							$(item).popover({
								container: "body",
								content: content,
								html: true,
								placement: "bottom",
								title: $(item).text(),
								trigger: "hover"
							});
						};

						// Set up the translator
						translator = new TextTranslator($("#definitions").get(0));
						translator.addTranslationEngine(arcliteTranslationEngine, 1, 3);
						translator.addTranslationEngine(wordReferenceTranslationEngine, 2, 2);
						translator.addTranslationEngine(googleTranslationEngine, 3, 1);

						// Load the resource
						new Resource(video.resourceId, function(resource) {

							// Install the html5 video player
							Ayamel.AddVideoPlayer(h5PlayerInstall, 1, function() {
								var player = $('#player').get(0),

									// Create the player
									videoPlayer = new Ayamel.VideoPlayer({
										element: player,
										aspectRatio: 45,
										resource: resource,
										components: ["play", "volume", "captions"]
									}),
									videoElement = $("#player").find("video").get(0),
									captionsElement = $("#captions").get(0);

								// Create the caption renderer
								renderer = new CaptionRenderer(videoElement, {
									appendCueCanvasTo: captionsElement,
									styleCue: function(DOMNode, track){
										SimpleAnnotator.annotate(matchData, DOMNode, annotatorHandler, annotatorSetup);
										translator.attach(DOMNode, track.language, "en");
										return DOMNode;
									}
								});

								// Bind the caption renderer to the video element
								renderer.bindMediaElement(videoElement);

								// Add the caption tracks
								var captionComponent = videoPlayer.controls.getComponent("captions");
								video.captionTracks.forEach(function (captionTrack) {

									// Start by getting the resource
									new Resource(captionTrack.resourceId, function (resource) {

										// Create a text track
										TextTrack.get({
											kind: "subtitles",
											label: captionTrack.name,
											lang: captionTrack.language,
											url: resource.content.files[0].downloadUri,
											success: function(){
												var track = this;
												renderer.addTextTrack(track);

												// If this is the first track then show it
												if(renderer.tracks.length === 1) {
													track.mode = 'showing';
												}

												// Add the track to the selection menu
												captionComponent.addTrack(track);
											}
										});
									});
								});
							});
						});
					});
					</pre>
				</code>
			</li>
		</ul>
    </div>

}
